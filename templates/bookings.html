{% extends "layout.html" %}
{% block content %}

<div class="page-head">
  <div>
    <h1>RÃ©servations</h1>
    <div class="muted">Tout se gÃ¨re ici. Trello reste â€œbackendâ€.</div>
  </div>

  <div class="stats">
    <div class="stat"><div class="n">{{stats.demandes}}</div><div class="l">Demandes</div></div>
    <div class="stat"><div class="n">{{stats.reserved}}</div><div class="l">RÃ©servÃ©es</div></div>
    <div class="stat"><div class="n">{{stats.ongoing}}</div><div class="l">En cours</div></div>
    <div class="stat"><div class="n">{{stats.done}}</div><div class="l">TerminÃ©es</div></div>
    <div class="stat"><div class="n">{{stats.cancel}}</div><div class="l">AnnulÃ©es</div></div>
  </div>
</div>

<div class="card form-card">
  <div class="card-title">CrÃ©er une demande</div>

  <form method="post" action="/bookings/create" class="grid">
    <div class="field">
      <label>Titre</label>
      <input name="title" placeholder="Ex: Location Clio 10-12 Jan" />
    </div>

    <div class="field">
      <label>Client</label>
      <input name="client" placeholder="Nom + TÃ©lÃ©phone (ex: Karim 0550...)" required />
    </div>

    <div class="field">
      <label>VÃ©hicule</label>
      <input name="vehicle" placeholder="ModÃ¨le / Immatriculation" required />
    </div>

    <div class="field">
      <label>Date dÃ©but</label>
      <input name="start" placeholder="YYYY-MM-DD" />
    </div>

    <div class="field">
      <label>Date fin</label>
      <input name="end" placeholder="YYYY-MM-DD" />
    </div>

    <div class="field">
      <label>Prix / jour (DZD)</label>
      <input name="ppd" placeholder="Ex: 8500" />
    </div>

    <div class="field">
      <label>DÃ©pÃ´t (DZD)</label>
      <input name="deposit" placeholder="Ex: 20000" />
    </div>

    <div class="field">
      <label>PayÃ© (DZD)</label>
      <input name="paid" placeholder="Ex: 17000" />
    </div>

    <div class="field">
      <label>Document</label>
      <select name="doc">
        <option value="">--</option>
        <option value="CNI">Carte Nationale (CNI)</option>
        <option value="PASSPORT">Passeport</option>
      </select>
    </div>

    <div class="field full">
      <label>Notes</label>
      <textarea name="notes" placeholder="Remarques, conditions, caution, etc."></textarea>
    </div>

    <div class="actions full">
      <button class="btn primary">CrÃ©er</button>
    </div>
  </form>
</div>

<div class="columns">

  <section class="col">
    <div class="col-head">
      <h3>ğŸ“¥ Demandes</h3>
      <span class="pill">{{ demandes|length }}</span>
    </div>
    {% for c in demandes %}
      <div class="card item">
        <div class="item-head">
          <div class="title">{{ c.name }}</div>
          <div class="muted small">#{{ c.id[:8] }}</div>
        </div>

        <div class="meta">
          <div><span class="tag">ğŸ‘¤</span> {{ c.client }}</div>
          <div><span class="tag">ğŸš—</span> {{ c.vehicle }}</div>
          <div><span class="tag">ğŸ“…</span> {{ c.start }} â†’ {{ c.end }}</div>
          <div><span class="tag">ğŸ’³</span> {{ c.ppd }} /j â€¢ DÃ©pÃ´t: {{ c.deposit }} â€¢ PayÃ©: {{ c.paid }}</div>
        </div>

        <div class="row">
          <form method="post" action="/bookings/move/{{c.id}}/reserved">
            <button class="btn">â¡ï¸ Confirmer</button>
          </form>
          <form method="post" action="/bookings/move/{{c.id}}/cancel">
            <button class="btn danger">Annuler</button>
          </form>
        </div>
      </div>
    {% endfor %}
  </section>

  <section class="col">
    <div class="col-head">
      <h3>ğŸ“… RÃ©servÃ©es</h3>
      <span class="pill">{{ reserved|length }}</span>
    </div>
    {% for c in reserved %}
      <div class="card item">
        <div class="item-head">
          <div class="title">{{ c.name }}</div>
          <div class="muted small">#{{ c.id[:8] }}</div>
        </div>

        <div class="meta">
          <div><span class="tag">ğŸ‘¤</span> {{ c.client }}</div>
          <div><span class="tag">ğŸš—</span> {{ c.vehicle }}</div>
          <div><span class="tag">ğŸ“…</span> {{ c.start }} â†’ {{ c.end }}</div>
        </div>

        <div class="row">
          <a class="btn" href="/bookings/contract.pdf/{{c.id}}">ğŸ“„ Contrat FR+AR</a>
          <form method="post" action="/bookings/move/{{c.id}}/ongoing">
            <button class="btn">ğŸ”‘ En cours</button>
          </form>
        </div>
      </div>
    {% endfor %}
  </section>

  <section class="col">
    <div class="col-head">
      <h3>ğŸ”‘ En cours</h3>
      <span class="pill">{{ ongoing|length }}</span>
    </div>
    {% for c in ongoing %}
      <div class="card item">
        <div class="item-head">
          <div class="title">{{ c.name }}</div>
          <div class="muted small">#{{ c.id[:8] }}</div>
        </div>

        <div class="meta">
          <div><span class="tag">ğŸ‘¤</span> {{ c.client }}</div>
          <div><span class="tag">ğŸš—</span> {{ c.vehicle }}</div>
          <div><span class="tag">ğŸ“…</span> {{ c.start }} â†’ {{ c.end }}</div>
        </div>

        <div class="row">
          <a class="btn" href="/bookings/contract.pdf/{{c.id}}">ğŸ“„ Contrat</a>
          <form method="post" action="/bookings/move/{{c.id}}/done">
            <button class="btn ok">âœ… Terminer</button>
          </form>
        </div>
      </div>
    {% endfor %}
  </section>

  <section class="col">
    <div class="col-head">
      <h3>âœ… TerminÃ©es</h3>
      <span class="pill">{{ done|length }}</span>
    </div>
    {% for c in done %}
      <div class="card item">
        <div class="item-head">
          <div class="title">{{ c.name }}</div>
          <div class="muted small">#{{ c.id[:8] }}</div>
        </div>
        <div class="meta">
          <div><span class="tag">ğŸ‘¤</span> {{ c.client }}</div>
          <div><span class="tag">ğŸš—</span> {{ c.vehicle }}</div>
        </div>
        <div class="row">
          <a class="btn" href="/bookings/contract.pdf/{{c.id}}">ğŸ“„ Contrat</a>
        </div>
      </div>
    {% endfor %}
  </section>

  <section class="col">
    <div class="col-head">
      <h3>âŒ AnnulÃ©es</h3>
      <span class="pill">{{ cancel|length }}</span>
    </div>
    {% for c in cancel %}
      <div class="card item">
        <div class="item-head">
          <div class="title">{{ c.name }}</div>
          <div class="muted small">#{{ c.id[:8] }}</div>
        </div>
        <div class="meta">
          <div><span class="tag">ğŸ‘¤</span> {{ c.client }}</div>
          <div><span class="tag">ğŸš—</span> {{ c.vehicle }}</div>
        </div>
        <div class="row">
          <form method="post" action="/bookings/move/{{c.id}}/demandes">
            <button class="btn">â†©ï¸ Remettre en demande</button>
          </form>
        </div>
      </div>
    {% endfor %}
  </section>

</div>

{% endblock %}

