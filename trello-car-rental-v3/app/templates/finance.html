{% extends "layout.html" %}
{% block content %}
<h2>Finance (Admin)</h2>

<div class="box">
  <b>Totaux</b>
  <div class="muted">PayÃ©: {{totals.paid}} | Ouvert: {{totals.open}} | DÃ©penses: {{totals.expenses}} | Profit estimÃ©: {{totals.profit_est}}</div>
  <div class="row">
    <a href="/finance/month_report.pdf">ğŸ“„ Rapport Fin de Mois PDF</a>
  </div>
</div>

<div class="box">
  <h3>CrÃ©er dÃ©pense</h3>
  <form method="post" action="/finance/expense/create">
    <div class="grid">
      <div><input name="date" placeholder="Date (YYYY-MM-DD)"></div>
      <div>
        <select name="category">
          <option value="fuel">Carburant</option>
          <option value="maintenance">Maintenance</option>
          <option value="wash">Lavage</option>
          <option value="fine">Amende</option>
          <option value="other">Autre</option>
        </select>
      </div>
      <div><input name="amount" placeholder="Montant"></div>
    </div>
    <textarea name="notes" placeholder="Notes"></textarea>
    <button>Ajouter dÃ©pense</button>
  </form>
</div>

<div class="grid">
  <div class="box">
    <h3>Factures ouvertes</h3>
    {% for c in inv_open %}
      <div class="card"><b>{{c.name}}</b></div>
    {% endfor %}
  </div>
  <div class="box">
    <h3>Factures payÃ©es</h3>
    {% for c in inv_paid %}
      <div class="card"><b>{{c.name}}</b></div>
    {% endfor %}
  </div>
</div>

<div class="box">
  <h3>DÃ©penses</h3>
  {% for c in expenses %}
    <div class="card"><b>{{c.name}}</b></div>
  {% endfor %}
</div>

<div class="box">
  <h3>CrÃ©er une facture (depuis une rÃ©servation)</h3>
  <div class="muted">Depuis lâ€™admin, tu peux â€œmarquer payÃ©â€ une rÃ©servation en crÃ©ant une invoice.</div>
  <div class="muted">Pour le moment, utilise lâ€™URL: /bookings puis bouton contrat + workflow, ensuite tu peux crÃ©er lâ€™invoice via lâ€™endpoint.</div>
  <div class="muted">(Je peux ajouter un Ã©cran dÃ©diÃ© invoice par rÃ©servation si tu veux.)</div>
</div>
{% endblock %}
