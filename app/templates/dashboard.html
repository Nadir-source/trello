{% extends "layout.html" %}
{% block content %}

<div class="page-head">
  <div>
    <h1>Dashboard</h1>
    <div class="muted">KPIs â€¢ aperÃ§u business â€¢ actions rapides</div>
    <div class="muted" style="margin-top:6px;">
      ConnectÃ©: <b>{{name}}</b> ({{role}})
      {% if board %}
        â€” Board: <a href="{{board.url}}" target="_blank">{{board.name}}</a>
      {% endif %}
    </div>
  </div>

  <div class="row">
    <a class="btn" href="/bookings">â• Nouvelle rÃ©servation</a>
    <a class="btn" href="/clients">ğŸ‘¤ Clients</a>
    <a class="btn" href="/vehicles">ğŸš— VÃ©hicules</a>
    <a class="btn" href="/finance">ğŸ’° Finance</a>
  </div>
</div>

<div class="kpi-grid">
  <div class="kpi kpi-blue"><div class="kpi-title">Demandes</div><div class="kpi-value">{{stats.demandes}}</div></div>
  <div class="kpi kpi-violet"><div class="kpi-title">RÃ©servÃ©es</div><div class="kpi-value">{{stats.reserved}}</div></div>
  <div class="kpi kpi-cyan"><div class="kpi-title">En cours</div><div class="kpi-value">{{stats.ongoing}}</div></div>
  <div class="kpi kpi-green"><div class="kpi-title">TerminÃ©es</div><div class="kpi-value">{{stats.done}}</div></div>

  <div class="kpi kpi-orange"><div class="kpi-title">Clients</div><div class="kpi-value">{{stats.clients}}</div></div>
  <div class="kpi kpi-pink"><div class="kpi-title">VÃ©hicules</div><div class="kpi-value">{{stats.vehicles}}</div></div>

  <div class="kpi"><div class="kpi-title">Factures ouvertes</div><div class="kpi-value">{{stats.invoices_open}}</div></div>
  <div class="kpi"><div class="kpi-title">Factures payÃ©es</div><div class="kpi-value">{{stats.invoices_paid}}</div></div>
</div>

<div class="columns" style="margin-top:16px;">
  <section class="col">
    <div class="col-head"><h3>ğŸ“¥ DerniÃ¨res demandes</h3><span class="pill">{{stats.demandes}}</span></div>
    {% if demandes %}
      {% for c in demandes %}
        <div class="card item">
          <div class="title">{{c.name}}</div>
          <div class="muted small">ID: {{c.id}}</div>
          <div class="row" style="margin-top:10px;">
            <a class="btn" href="/bookings">Ouvrir</a>
          </div>
        </div>
      {% endfor %}
    {% else %}
      <div class="card item"><div class="muted">Aucune demande.</div></div>
    {% endif %}
  </section>

  <section class="col">
    <div class="col-head"><h3>ğŸ“… RÃ©servÃ©es</h3><span class="pill">{{stats.reserved}}</span></div>
    {% if reserved_cards %}
      {% for c in reserved_cards %}
        <div class="card item">
          <div class="title">{{c.name}}</div>
          <div class="muted small">ID: {{c.id}}</div>
          <div class="row" style="margin-top:10px;">
            <a class="btn primary" href="/bookings">Voir</a>
          </div>
        </div>
      {% endfor %}
    {% else %}
      <div class="card item"><div class="muted">Aucune rÃ©servation.</div></div>
    {% endif %}
  </section>

  <section class="col">
    <div class="col-head"><h3>ğŸ”‘ En cours</h3><span class="pill">{{stats.ongoing}}</span></div>
    {% if ongoing_cards %}
      {% for c in ongoing_cards %}
        <div class="card item">
          <div class="title">{{c.name}}</div>
          <div class="muted small">ID: {{c.id}}</div>
        </div>
      {% endfor %}
    {% else %}
      <div class="card item"><div class="muted">Aucune location en cours.</div></div>
    {% endif %}
  </section>
</div>

{% endblock %}

