{% extends "layout.html" %}
{% block content %}

<div class="page-head">
  <div>
    <h1>Dashboard</h1>
    <div class="muted">Vue rapide + actions + Ã©tat du business</div>
  </div>

  <div class="row gap">
    <a class="btn primary" href="/bookings">â• Nouvelle rÃ©servation</a>
    <a class="btn" href="/finance">ğŸ“Š Voir finance</a>
  </div>
</div>

<div class="grid-4">
  <div class="metric neon-cyan">
    <div class="k">ğŸ“¥ Demandes</div>
    <div class="v">{{ stats.demandes }}</div>
    <div class="bar"><span style="width: {{ (stats.demandes * 10) if stats.demandes < 10 else 100 }}%"></span></div>
  </div>

  <div class="metric neon-purple">
    <div class="k">ğŸ“… RÃ©servÃ©es</div>
    <div class="v">{{ stats.reserved }}</div>
    <div class="bar"><span style="width: {{ (stats.reserved * 10) if stats.reserved < 10 else 100 }}%"></span></div>
  </div>

  <div class="metric neon-green">
    <div class="k">ğŸ”‘ En cours</div>
    <div class="v">{{ stats.ongoing }}</div>
    <div class="bar"><span style="width: {{ (stats.ongoing * 10) if stats.ongoing < 10 else 100 }}%"></span></div>
  </div>

  <div class="metric neon-orange">
    <div class="k">âœ… TerminÃ©es</div>
    <div class="v">{{ stats.done }}</div>
    <div class="bar"><span style="width: {{ (stats.done * 10) if stats.done < 10 else 100 }}%"></span></div>
  </div>
</div>

<div class="grid-2 mt">
  <div class="card neon">
    <div class="card-head">
      <div>
        <div class="card-title">ğŸ“Œ Ã€ traiter</div>
        <div class="muted">Les 3 derniÃ¨res demandes</div>
      </div>
      <a class="btn" href="/bookings">Ouvrir</a>
    </div>

    <div class="list">
      {% if demandes and demandes|length > 0 %}
        {% for c in demandes[:3] %}
          <div class="list-row">
            <div class="list-main">
              <div class="t">{{ c.name }}</div>
              <div class="muted small">ğŸ‘¤ {{ c.client }} â€¢ ğŸš— {{ c.vehicle }} â€¢ ğŸ“… {{ c.start }} â†’ {{ c.end }}</div>
            </div>
            <div class="list-actions">
              <a class="btn" href="/bookings">Voir</a>
            </div>
          </div>
        {% endfor %}
      {% else %}
        <div class="empty">Aucune demande pour le moment.</div>
      {% endif %}
    </div>
  </div>

  <div class="card neon">
    <div class="card-head">
      <div>
        <div class="card-title">ğŸ’° Finance</div>
        <div class="muted">Factures / paiements</div>
      </div>
      <a class="btn" href="/finance">DÃ©tails</a>
    </div>

    <div class="grid-2">
      <div class="mini metric neon-cyan">
        <div class="k">ğŸ§¾ Factures ouvertes</div>
        <div class="v">{{ stats.invoices_open }}</div>
      </div>
      <div class="mini metric neon-green">
        <div class="k">âœ… Factures payÃ©es</div>
        <div class="v">{{ stats.invoices_paid }}</div>
      </div>
      <div class="mini metric neon-red">
        <div class="k">âŒ AnnulÃ©es</div>
        <div class="v">{{ stats.cancel }}</div>
      </div>
      <div class="mini metric neon-purple">
        <div class="k">ğŸ“¦ Total activitÃ©</div>
        <div class="v">{{ stats.demandes + stats.reserved + stats.ongoing + stats.done }}</div>
      </div>
    </div>

    <div class="note mt">
      <div class="muted">
        Objectif: <b>tout faire dans le site</b> (ton ami ne touche jamais Trello).
        Toi tu gardes Trello comme â€œbaseâ€ et tu surveilles.
      </div>
    </div>
  </div>
</div>

{% endblock %}

