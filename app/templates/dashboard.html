{% extends "layout.html" %}
{% block content %}
<div class="px-6 py-6 text-white">

  <script src="https://cdn.tailwindcss.com"></script>

  <div class="mb-8">
    <div>
      <h1 class="text-3xl font-bold flex items-center gap-2">ğŸ“Š Dashboard</h1>
      <p class="text-gray-400 mt-1">KPIs â€¢ aperÃ§u business â€¢ actions rapides</p>
    </div>

    <div class="flex flex-wrap gap-3 mt-4">
      <a href="/bookings" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded">â• Nouvelle rÃ©servation</a>
      <a href="/clients" class="px-4 py-2 bg-gray-700 hover:bg-gray-800 text-white rounded">ğŸ‘¤ Clients</a>
      <a href="/vehicles" class="px-4 py-2 bg-gray-700 hover:bg-gray-800 text-white rounded">ğŸš— VÃ©hicules</a>
      <a href="/finance" class="px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded">ğŸ’° Finance</a>
    </div>
  </div>

  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
    <div class="bg-gray-900 p-4 rounded-lg border-l-4 border-blue-500">
      <p class="text-gray-400 text-sm">ğŸ“¥ Demandes</p>
      <p class="text-2xl font-bold text-white">{{ stats.demandes }}</p>
    </div>
    <div class="bg-gray-900 p-4 rounded-lg border-l-4 border-purple-500">
      <p class="text-gray-400 text-sm">ğŸ“… RÃ©servÃ©es</p>
      <p class="text-2xl font-bold text-white">{{ stats.reserved }}</p>
    </div>
    <div class="bg-gray-900 p-4 rounded-lg border-l-4 border-cyan-500">
      <p class="text-gray-400 text-sm">ğŸ”‘ En cours</p>
      <p class="text-2xl font-bold text-white">{{ stats.ongoing }}</p>
    </div>
    <div class="bg-gray-900 p-4 rounded-lg border-l-4 border-green-500">
      <p class="text-gray-400 text-sm">âœ… TerminÃ©es</p>
      <p class="text-2xl font-bold text-white">{{ stats.done }}</p>
    </div>

    <div class="bg-gray-900 p-4 rounded-lg border-l-4 border-yellow-400">
      <p class="text-gray-400 text-sm">ğŸ‘¤ Clients</p>
      <p class="text-2xl font-bold text-white">{{ stats.clients }}</p>
    </div>
    <div class="bg-gray-900 p-4 rounded-lg border-l-4 border-pink-500">
      <p class="text-gray-400 text-sm">ğŸš— VÃ©hicules</p>
      <p class="text-2xl font-bold text-white">{{ stats.vehicles }}</p>
    </div>

    <div class="bg-gray-900 p-4 rounded-lg border-l-4 border-orange-400">
      <p class="text-gray-400 text-sm">ğŸ§¾ Factures ouvertes</p>
      <p class="text-2xl font-bold text-white">{{ stats.invoices_open }}</p>
    </div>
    <div class="bg-gray-900 p-4 rounded-lg border-l-4 border-green-400">
      <p class="text-gray-400 text-sm">âœ… Factures payÃ©es</p>
      <p class="text-2xl font-bold text-white">{{ stats.invoices_paid }}</p>
    </div>

    <div class="bg-gray-900 p-4 rounded-lg border-l-4 border-green-500">
      <p class="text-gray-400 text-sm">ğŸ’° Revenu encaissÃ©</p>
      <p class="text-2xl font-bold text-white">{{ stats.revenue_paid }} â‚¬</p>
    </div>
    <div class="bg-gray-900 p-4 rounded-lg border-l-4 border-yellow-300">
      <p class="text-gray-400 text-sm">ğŸ•’ En attente de paiement</p>
      <p class="text-2xl font-bold text-white">{{ stats.revenue_open }} â‚¬</p>
    </div>
    <div class="bg-gray-900 p-4 rounded-lg border-l-4 border-red-400">
      <p class="text-gray-400 text-sm">ğŸ’¸ DÃ©penses</p>
      <p class="text-2xl font-bold text-white">{{ stats.expenses }} â‚¬</p>
    </div>
    <div class="bg-gray-900 p-4 rounded-lg border-l-4 border-indigo-500">
      <p class="text-gray-400 text-sm">ğŸ“ˆ BÃ©nÃ©fice estimÃ©</p>
      <p class="text-2xl font-bold text-white">{{ stats.estimated_profit }} â‚¬</p>
    </div>
  </div>

  <div class="grid md:grid-cols-2 gap-6 mt-10">
    <div class="bg-gray-900 p-6 rounded-lg">
      <h3 class="text-white text-lg font-semibold mb-4">ğŸ“Š RÃ©partition des rÃ©servations</h3>
      <canvas id="bookingsChart" height="200"></canvas>
    </div>
    <div class="bg-gray-900 p-6 rounded-lg">
      <h3 class="text-white text-lg font-semibold mb-4">ğŸ’° Finances</h3>
      <canvas id="financeChart" height="200"></canvas>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  const bookingsData = {
    labels: ['Demandes', 'RÃ©servÃ©es', 'En cours', 'TerminÃ©es', 'AnnulÃ©es'],
    datasets: [{
      label: 'RÃ©servations',
      data: [
        {{ stats.demandes }},
        {{ stats.reserved }},
        {{ stats.ongoing }},
        {{ stats.done }},
        {{ stats.canceled }}
      ],
      backgroundColor: ['#3B82F6', '#8B5CF6', '#10B981', '#22D3EE', '#EF4444']
    }]
  };
  new Chart(document.getElementById('bookingsChart'), {
    type: 'pie',
    data: bookingsData
  });

  const financeData = {
    labels: ['Revenu', 'DÃ©penses', 'Profit'],
    datasets: [{
      label: 'Montant (â‚¬)',
      data: [
        {{ stats.revenue_paid }},
        {{ stats.expenses }},
        {{ stats.estimated_profit }}
      ],
      backgroundColor: ['#10B981', '#F97316', '#6366F1']
    }]
  };
  new Chart(document.getElementById('financeChart'), {
    type: 'bar',
    data: financeData,
    options: { scales: { y: { beginAtZero: true } } }
  });
</script>
{% endblock %}

